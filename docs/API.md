# 카페테리아 서버 API v1.4.0

문서 수정 내역

| 수정일 | 내용 |
| - | - |
| 2020.02.27 | 최초 작성 |
| 2020.02.29 | 버전 이름 수정 |
| 2020.03.08 | 기존 API 지원 & 새 피드백 기능 추가 |
| 2020.09.13 | 카페테리아/코너 API 수정 |

# Cafeteria

## GET /cafeteria

모든 식당 목록을 가져옵니다.

### 요청 모델

없음

### 응답 모델 (JSON)

**응답코드 200**:

아래 모델의 배열:

| 이름 | 타입 | 설명 |
| - | - | - |
| id | 숫자 | 식당의 식별자 |
| name | 문자열 | 식당의 실제 이름 |
| display-name | 문자열 | 식당의 표시 이름 |
| image-path | 문자열 | 식당 이미지 경로 |
| support-menu | 불리언 | 식단 정보 지원 여부 |
| support-discount | 불리언 | 할인 제공 여부 |
| support-notification | 불리언 | 번호 알림 제공 여부 |

**응답코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |

## GET /cafeteria/{id}

지정된 id를 식별자로 가지는 식당을 가져옵니다.

### 요청 모델

**path**:

| 이름 | 타입 | 설명 | 필수 |
| - | - | - | - |
| id | 숫자 | 가져오고자 하는 식당의 식별자 | 참 |

### 응답 모델 (JSON)

**응답코드 200**:

| 이름 | 타입 | 설명 |
| - | - | - |
| id | 숫자 | 식당의 식별자 |
| name | 문자열 | 식당의 실제 이름 |
| display-name | 문자열 | 식당의 표시 이름 |
| image-path | 문자열 | 식당 이미지 경로 |
| support-menu | 불리언 | 식단 정보 지원 여부 |
| support-discount | 불리언 | 할인 제공 여부 |
| support-notification | 불리언 | 번호 알림 제공 여부 |

**응답코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |


# Corners

## GET /corners

코너를 모두 가져옵니다.

### 요청 모델

**query**:

| 이름 | 타입 | 설명 | 필수 |
| - | - | - | - |
| cafeteriaId | 숫자 | 해당 코너가 속한 식당의 식별자 | 거짓 |

### 응답 모델 (JSON)

**응답코드 200**:

아래 모델의 배열:

| 이름 | 타입 | 설명 |
| - | - | - |
| id | 숫자 | 코너의 식별자 |
| name | 문자열 | 코너의 실제 이름 |
| display-name | 문자열 | 코너의 표시 이름 |
| available-at | 숫자 | 이용 가능한 시간 |
| cafeteria-id | 숫자 | 해당 코너가 속한 식당의 식별자 |

**응답코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |

## GET /corners/{id}

### 요청 모델

**path**:

| 이름 | 타입 | 설명 | 필수 |
| - | - | - | - |
| id | 숫자 | 가져오고자 하는 코너의 식별자 | 참 |

### 응답 모델 (JSON)

**응답코드 200**:

| 이름 | 타입 | 설명 |
| - | - | - |
| id | 숫자 | 코너의 식별자 |
| name | 문자열 | 코너의 실제 이름 |
| display-name | 문자열 | 코너의 표시 이름 |
| available-at | 숫자 | 이용 가능한 시간 |
| cafeteria-id | 숫자 | 해당 코너가 속한 식당의 식별자 |

**응답코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |


# Menus

식단 정보를 가져옵니다.

## GET /menus

### 요청 모델

**query**:

| 이름 | 타입 | 설명 | 필수 |
| - | - | - | - |
| date | 문자열 | 원하는 식단의 날짜 | 거짓 |
| cornerId | 숫자 | 메뉴가 속한 코너의 식별자 | 거짓 |

### 응답 모델 (JSON)

**응답코드 200**:

아래 모델의 배열:

| 이름 | 타입 | 설명 |
| - | - | - |
| corner-id | 숫자 | 해당 메뉴가 속한 코너의 id |
| foods | 문자열 | 공백 문자로 구분되는 소메뉴들 |
| price | 숫자 | 메뉴의 가격 |
| calorie | 숫자 | 메뉴의 열량 |

**응답코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |


# User

## POST /login

로그인을 요청합니다.

### 요청 모델

**body**:

| 이름 | 타입 | 설명 | 필수 |
| - | - | - | - |
| token | 문자열 | 로그인 토큰 | 필수 |

또는

| 이름 | 타입 | 설명 | 필수 |
| - | - | - | - |
| id | 문자열 | 학번 | 필수 |
| password | 문자열 | 비밀번호 | 필수 |

### 응답 모델 (JSON):

**응답코드 200**:

| 이름 | 타입 | 설명 |
| - | - | - |
| id | 숫자 | 학번 |
| token | 문자열 | 로그인 토큰 |
| barcode | 문자열 | 발급된 바코드 |

**응답코드 400, 401, 403, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |

## POST /logout

로그아웃을 요청합니다.

### 요청 모델

없음

### 응답 모델 (JSON)

**응답코드 204**:

없음

**응답코드 401, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |


# Interaction

## POST /feedback

피드백을 보냅니다.

### 요청 모델

**body**:

| 이름 | 타입 | 설명 | 필수 |
| - | - | - | - |
| content | 문자열 | 피드백 내용 | 필수 |

### 응답 모델 (JSON)

**응답코드 204**:

없음

**응답코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |

## GET /notifications

피드백에 달린 답변을 가져옵니다.

### 요청 모델

없음

### 응답 모델 (JSON)

**응답 코드 200**:

아래 모델의 배열:

| 이름 | 타입 | 설명 |
| - | - | - |
| title | 문자열 | 제목 |
| body | 문자열 | 본문 |

**응답 코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |

## GET /notices

공지를 가져옵니다.

### 요청 모델

없음

### 응답 모델 (JSON)

**응답 코드 200**:

아래 모델의 배열:

| 이름 | 타입 | 설명 |
| - | - | - |
| id | 숫자 | 공지 번호 |
| title | 문자열 | 제목 |
| body | 문자열 | 본문 |

**응답 코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |


# Transaction

## PUT /activateBarcode

바코드를 10분동안 활성화합니다.

### 요청 모델

없음

### 응답 모델 (JSON)

**응답 코드 204**:

없음

**응답 코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |

## GET /isBarcode

할인 적용 시간, 바코드 활성화 여부, 최근 할인 기록 등을 종합하여 할인 가능 여부를 판단합니다.

### 요청 모델

| 이름 | 타입 | 설명 |
| - | - | - |
| barcode | 문자열 | 사용자의 바코드 |
| code | 숫자 | 사용자가 태그한 식당 코드 |
| menu | 문자열 | 메뉴 |

### 응답 모델 (JSON)

**응답 코드 200**:

| 이름 | 타입 | 설명 |
| - | - | - |
| message | 문자열 | 결과 메시지 |
| activated | 숫자 | 성공 여부. 성공:1 실패:0 |

**응답 코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |

## GET /paymentSend

할인 트랜잭션을 확정하여 기록 또는 삭제합니다.

### 요청 모델

| 이름 | 타입 | 설명 |
| - | - | - |
| barcode | 문자열 | 사용자의 바코드 |
| code | 숫자 | 사용자가 태그한 식당 코드 |
| menu | 문자열 | 메뉴 |
| payment | 문자 | 확정:'Y' 취소:'N' |

### 응답 모델 (JSON)

**응답 코드 200**:

| 이름 | 타입 | 설명 |
| - | - | - |
| message | 문자열 | 결과 메시지 |

**응답 코드 400, 500**:

| 이름 | 타입 | 설명 |
| - | - | - |
| statusCode | 숫자 | HTTP 에러 상태 코드 |
| error | 문자열 | HTTP 에러 상태 이름 |
| message | 문자열 | 에러 메시지 |
